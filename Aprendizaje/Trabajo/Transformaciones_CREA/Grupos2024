import pandas as pd
import csv

# Ruta del archivo CSV de entrada
ruta_csv = r'/home/sebastian/Downloads/BI_EST_GDE_CTRL1.csv'

# Ruta del archivo CSV de salida
nuevo_csv = r'/home/sebastian/Downloads/BI_EST_GDE_CTRL_MODIFIED.csv'

columnas_coso = ['ID_CURSO','EMPLID_LIDER']

# Leer el archivo CSV
df = pd.read_csv(ruta_csv, dtype={col:str for col in columnas_coso }, sep='|', encoding='utf-8')

# Modificar la columna NUM_GRUPO para registros con CICLO_LECTIVO '2024-1'
df.loc[df['CICLO_LECTIVO'] == '2024-1', 'NUM_GRUPO'] = ''

# Guardar el DataFrame modificado en un nuevo archivo CSV con el separador '|'
df.to_csv(nuevo_csv, sep='|', index=False, encoding='utf-8', quoting=csv.QUOTE_NONE, escapechar=' ')

print(f"Archivo modificado y guardado en: {nuevo_csv}")
